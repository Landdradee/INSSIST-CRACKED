(async()=>{var e=(e,t)=>()=>(e&&(t=e(e=0)),t),t,n=e((()=>{(()=>{let e=`production`,n=e===`development`;if(t=globalThis.app,t)return;let r={name:`app`,env:e,get:e=>e in r?r[e]:null,...JSON.parse(`{"version":"36.0.1","manifestVersion":3}`)},i=a(r);globalThis.app=i,n&&(globalThis.$app=r),t=i;function a(e){let t=e===r,i=t&&n,c={},l=t=>Object.assign(e,t);return new Proxy(e,{get(n,r){if(r===`assign`)return l;if(t&&!String(r).startsWith(`$`))return e[r];if(!(r in e)){if(e[r]={},t){let t=o.bind(null,`log`,r,!1),n=o.bind(null,`log`,r,!0),i=o.bind(null,`warn`,r,!1),a=o.bind(null,`warn`,r,!0),c=o.bind(null,`error`,r,!1),l=o.bind(null,`error`,r,!0),u=s.bind(null,r);Object.defineProperties(e[r],{log:{get:()=>t},logDev:{get:()=>n},warn:{get:()=>i},warnDev:{get:()=>a},error:{get:()=>c},errorDev:{get:()=>l},Error:{get:()=>u}})}c[r]=a(e[r]),i&&(globalThis[r]=e[r])}return r in c?c[r]:e[r]},set(t,n,r){return e[n]=r,c[n]=r,i&&(globalThis[n]=e[n]),!0}})}function o(e,t,r,...i){if(r&&!n)return;let[a,o,s]=c(t);console[e](`%c[${t}]`,`color: rgb(${a}, ${o}, ${s})`,...i)}function s(e,t,...n){return n.length>0&&o(`error`,e,!1,t,...n),Error(`[${e}] ${t}`)}function c(e){let t=0;e.split(``).forEach((n,r)=>{t=e.charCodeAt(r)+((t<<5)-t)});let n=(t&16711680)>>16,r=(t&65280)>>8,i=t&255;return n+r+i<300?c(`$${e}`):[n,r,i]}})()}));function r(e,t){return`${e}|${JSON.stringify(t)}`}function i(){return window.self.name.split(`|`)[0]||null}function a(){let e=window.self.name.split(`|`)[1];return s.safeJsonParse(e)||{}}function o(e=null){return typeof window>`u`?!1:window.self!==parent&&(!e||i()===e)}var s,c=e((()=>{({$utils:s}=app),s.iframe={createName:r,getName:i,getParams:a,isIframe:o}})),l,u=e((()=>{({$utils:l}=app),l.is={null:e=>e===null,defined:e=>e!==void 0,undefined:e=>e===void 0,nil:e=>e==null,boolean:e=>typeof e==`boolean`,number:e=>typeof e==`number`,string:e=>typeof e==`string`,symbol:e=>typeof e==`symbol`,function:e=>typeof e==`function`,map:e=>e instanceof Map,set:e=>e instanceof Set,url:e=>e instanceof URL,blob:e=>e instanceof Blob,file:e=>e instanceof File,error:e=>e instanceof Error,regexp:e=>e instanceof RegExp,promise:e=>e instanceof Promise,array:e=>Array.isArray(e),object:e=>Object.prototype.toString.call(e)===`[object Object]`,objectOrArray:e=>l.is.object(e)||l.is.array(e),nan:e=>Number.isNaN(e),numeric:e=>!l.is.nan(Number(e)),empty:e=>l.is.nil(e)?!0:l.is.array(e)?e.length===0:l.is.object(e)?Object.keys(e).length===0:l.is.string(e)?e.trim().length===0:!1}})),d,f,ee=e((()=>{({$utils:d,$bus:f}=app),d.objectUrl={create(e,t=!1){if(!URL.createObjectURL)return f.send(`utils.objectUrl.create`,e,t);let n=URL.createObjectURL(e);if(t){let e=d.is.number(t)?t:6e4;setTimeout(()=>URL.revokeObjectURL(n),e)}return n},revoke(e){if(!URL.revokeObjectURL)return f.send(`utils.objectUrl.revoke`,e);URL.revokeObjectURL(e)}}})),te,ne=e((()=>{({$utils:te}=app),te.safeJsonParse=e=>{try{return JSON.parse(e)}catch{return null}}})),p,m,h,g,_,v,y,b,x,S,C,re=e((()=>{({$utils:p}=app),m=1e3,h=60*m,g=60*h,_=24*g,v=7*_,y=31*_,b=365*_,x=[`Sun`,`Mon`,`Tue`,`Wed`,`Thu`,`Fri`,`Sat`],S=[`January`,`February`,`March`,`April`,`May`,`June`,`July`,`August`,`September`,`October`,`November`,`December`],C=e=>{let t=e/m,n=e/h,r=e/g,i=e/_;return t<5?`a few seconds`:t<90?`1 minute`:n<45?`${Math.round(n)} minutes`:n<120?`1 hour`:r<24?`${Math.round(r)} hours`:r<48?`1 day`:`${Math.round(i)} days`},p.time={SECOND:m,MINUTE:h,HOUR:g,DAY:_,WEEK:v,MONTH:y,YEAR:b,weekdays:x,months:S,formatDuration:C}})),w,ie=e((()=>{({$utils:w}=app),w.waitFor=async(e,t=null)=>{let n,r;return typeof t==`number`?(n=t,r=100):t?(n=t.timeout||3e4,r=t.frequency||100):(n=3e4,r=100),await new Promise(async(t,i)=>{let a=await e();if(a){t(a);return}let o=setInterval(async()=>{let n=await e();n&&(clearInterval(o),clearTimeout(s),t(n))},r),s=setTimeout(()=>{clearInterval(o),t(null)},n)})}})),T,E,ae=e((()=>{({$env:T,$utils:E}=app),T.controller={init(){let e=app.env,t=this._getLocus();this._production=e===`production`,this._development=e===`development`,Object.assign(T,{version:app.version,backup:this._getBackup(),features:this._getFeatures(),options:this._getOptions(),locus:t,env:e,is:{bg:t===`bg`,cs:t.startsWith(`cs`),csFrame:t===`csFrame`,csMobile:t===`csMobile`,csDesktop:t===`csDesktop`,nj:t===`nj`,os:t===`os`,pp:t.startsWith(`pp`),ppFrame:t===`ppFrame`,ppMobile:t===`ppMobile`,ppDesktop:t===`ppDesktop`,ppPermissions:t===`ppPermissions`,production:this._production,development:this._development}})},logReady(){T.log(`running ${T.locus} ${app.version} ${T.env}`)},_getLocus(){if(location.protocol===`chrome-extension:`)return location.pathname===`/app/bg.js`?`bg`:location.pathname===`/offscreen.html`?`os`:new URL(location.href).searchParams.has(`permissions`)?`ppPermissions`:`ppMobile`;{let e=self.chrome&&chrome.extension;return self.top===self?e?`csDesktop`:`ppDesktop`:self.name===`pp-frame`?e?`csFrame`:`ppFrame`:e?`csMobile`:`nj`}},_getBackup(){return{url:`https://inssist.com/backup`}},_getFeatures(){return{fspring:!0,iframes:!0,log:this._development}},_getOptions(){return{apiUrl:`https://api.inssist.com/api/v1`,domain:`inssist.com`,storefront:this._production?`slashed.onfastspring.com`:`slashed.test.onfastspring.com`,storefrontId:`embedded-inssist`,checkoutContainer:`https://inssist.com`,billingPlans:this._getBillingPlans(),billingProFeaturesList:this._getBillingProFeaturesList(),billingProFeaturesTable:this._getBillingProFeaturesTable(),tagAssist:this._getTagAssist()}},_getBillingPlans(){let e=(e,t)=>!e.tags?.accounts||e.tags.accounts.some(e=>e.id===t?.userId||e.name===t?.username),t=Date.now()-E.time.MONTH-E.time.DAY;return{"inssist-pro-monthly":{type:`subscription`,pricing:{US:{currency:`USD`,price:9.5}},isActive:(n,{allowCancelled:r=!0}={})=>{let{$s:i}=app;if(!(i.billing.orders||[]).filter(e=>e.created>=t).some(t=>t.product===`inssist-pro-monthly`&&e(t,n.auth)))return!1;let a=Date.now(),o=i.billing.subscriptions?.[`inssist-pro-monthly`]||{};return!!(o.state===`active`||o.state===`canceled`&&a<=o.next&&r)}},"inssist-pro-lifetime":{type:`product`,pricing:{US:{currency:`USD`,price:95}},isActive:t=>{let{$s:n}=app;return(n.billing.orders||[]).some(n=>n.product===`inssist-pro-lifetime`&&e(n,t.auth))}},"inssist-pro-infinite":{type:`product`,pricing:{US:{currency:`USD`,price:240}},isActive:()=>{let{$s:e}=app;return(e.billing.orders||[]).some(e=>e.product===`inssist-pro-infinite`)}}}},_getBillingProFeaturesList(){return[{id:`schedule`,icon:`sidebar-mediator.later`,title:`Post Later`,description:`
          Schedule photos, videos, carousels, stories and reels.
          Use Time Slots to schedule content rapidly.
        `},{id:`hashtags`,icon:`sidebar-mediator.hashtags`,title:`Hashtag Assistant`,description:`
          Find effective hashtags to increase your engagement.
          Create hashtag collections.
        `},{id:`reels`,icon:`sidebar-mediator.covers`,title:`Reels and Video Stories`,description:`
          Publish Videos and Video Stories from your desktop PC / Mac.
        `},{id:`music`,icon:`sidebar-mediator.music`,title:`Music, Covers, Ghost View`,description:`
          Add music to your videos. Select or upload custom covers.
          View stories and read DMs anonymously.
        `}]},_getBillingProFeaturesTable(){return[{id:`story`,list:[{title:`PUBLISH PHOTOS, VIDEOS, REELS`,isFree:!0},{title:`PUBLISH PHOTO & VIDEO STORIES`,isFree:!0},{title:`ADD *MENTIONS* TO STORIES`},{title:`ADD *CUSTOM LINKS* TO STORIES`},{title:`ADD *CUSTOM COVERS* TO VIDEOS`},{title:`ADD *MUSIC* TO STORIES`},{title:`ADD *MUSIC* TO VIDEOS`}]},{id:`later`,list:[{title:`POST *LATER*`},{title:`POSTING *CALENDAR & TIME SLOTS*`},{title:`BULK *CSV* SCHEDULING`}]},{id:`inspirations`,list:[{title:`SAVE & REPOST PINNED POSTS`,isFree:!0}]},{id:`templates`,list:[{title:`DM TEMPLATES`,isFree:!0}]},{id:`hashtags`,list:[{title:`HASHTAG ASSIST`,isFree:!0},{title:`HASHTAG *METRICS & COLLECTIONS*`}]},{id:`ghost`,list:[{title:`GHOST MODE *FOR STORIES*`},{title:`GHOST MODE *FOR DM*`}]},{id:`blocker`,list:[{title:`AD BLOCKER`,isFree:!0}]},{id:`scripts`,list:[{title:`*GROWTH* ASSIST`,subtitle:`* available on Monthly Plan`}]}]},_getTagAssist(){return{apiUrl:`https://fc.inssist.com/api/v1/hashtag`,collectionsTagDataTtl:1*E.time.MONTH,maxTagsToQuery:5,maxRelevantTagsToKeep:100,accountStatsTtl:1*E.time.DAY}}}})),D,O,k,oe=e((()=>{({$bus:D,$env:O,$utils:k}=app),D.controller={init(){D.on=this.on.bind(this),D.off=this.off.bind(this),D.once=this.once.bind(this),D.send=this._wrapThrowIfError(this.send),D.call=this._wrapThrowIfError(this.call),D.poll=this.poll.bind(this),D.getTabId=this.getTabId.bind(this),D.getWindowId=this.getWindowId.bind(this),this._locus=this._getLocus(),this._serialize=this._serialize.bind(this),this._handlers={},this._is(`ppExt`)?this._setupPpExt():this._is(`bg`)?(this._blobs={},this._channel=new BroadcastChannel(`bus.channel`),this._setupBg()):this._is(`csDesktop`)?(this._token=crypto.randomUUID(),this._setupCsDesktop()):this._is(`ppDesktop`)?(this._token=globalThis.__$busToken__,delete globalThis.__$busToken__,this._setupPpDesktop()):this._is(`os`)?(D.setIframe=this._setIframe.bind(this),this._iframe=null,this._channel=new BroadcastChannel(`bus.channel`),this._setupOs()):this._is(`ppFrame`)&&this._setupPpFrame()},on(e,t,n=null){this._on(e,null,t,n)},off(e,t=null){this._off(e,null,t)},once(e,t){let n=async(...r)=>(this.off(e,n),await t(...r));this.on(e,n)},async send(e,...t){if(!k.is.nan(Number(e))){let n=Number(e);return e=t[0],t=t.slice(1),await this._sendToTab(n,e,...t)}if(this._is(`ppExt`))return await this._sendToExt(e,...t);if(this._is(`ppDesktop`))return await this._sendToPage(e,...t);if(this._is(`ppFrame`))return await this._sendToParent(e,...t);if(this._is(`bg`,`csDesktop`,`os`))return await this._pick([this._sendToExt(e,...t),this._callHandlers({name:e,args:t},e=>e.proxy)])},async call(e,...t){return this._callHandlers({name:e,args:t},e=>!e.proxy)},async poll(e,...t){return await k.waitFor(()=>this.send(e,...t))},async getTabId(){if(this._is(`bg`))return null;let{tabId:e}=await this.send(`bus.getTabData`);return e},async getWindowId(){if(this._is(`bg`))return null;let{windowId:e}=await this.send(`bus.getTabData`);return e},_getLocus(){let e=O.locus;return e===`ppMobile`||e===`ppPermissions`?`ppExt`:e},_on(e,t,n,r=null){if(this._handlers[e]||(this._handlers[e]=[]),this._is(`csDesktop`,`ppDesktop`,`ppFrame`)&&this._handlers[e].length===0)async:this._sendToProxier(`bus.proxy`,e,!0);let i={fn:n,name:e};t&&(i.proxy=t),r&&(i.this=r),this._handlers[e].push(i)},_off(e,t=null,n=null){if(this._handlers[e]&&(this._handlers[e]=this._handlers[e].filter(e=>{let r=!n||n===e.fn,i=t===(e.proxy||null);return!(r&&i)}),this._handlers[e].length===0&&(delete this._handlers[e],this._is(`csDesktop`,`ppDesktop`,`ppFrame`))))async:this._sendToProxier(`bus.proxy`,e,!1)},_setupPpExt(){chrome.runtime.onMessage.addListener((e,t,n)=>{if(!this._isBusMsg(e))return;let r=this._callHandlers(e);if(r)return r.then(this._serialize).then(n),!0})},_setupBg(){chrome.runtime.onMessage.addListener((e,t,n)=>{if(!this._isBusMsg(e))return;let r=t.tab?.id||null;if(e.name===`bus.proxy`){run:(async()=>{let[t,n]=await this._deserialize(e.argsStr);if(!r)return;let i=`cs-${r}`;n?this._on(t,i,(...e)=>this._sendToTab(r,t,...e)):this._off(t,i)})();return}if(e.name===`bus.removeCsProxies`){this._removeProxyHandlers(`cs-${r}`);return}if(e.name===`bus.getTabData`){let e=t.tab?.windowId||null;return n(this._serialize({tabId:r,windowId:e})),!0}if(e.name===`bus.sendToTab`){run:(async()=>{let t=await this._deserialize(e.argsStr),r=await this._sendToTab(...t);n(this._serialize(r))})();return!0}if(e.name===`bus.blobIdToObjectUrl`){run:(async()=>{let[t]=await this._deserialize(e.argsStr),r=await this._blobIdToObjectUrl(t);n(this._serialize(r))})();return!0}let i=this._callHandlers(e,e=>e.proxy!==`cs-${r}`);if(i)return i.then(this._serialize).then(n),!0}),chrome.tabs.onRemoved.addListener(e=>{this._removeProxyHandlers(`cs-${e}`)})},_setupCsDesktop(){chrome.runtime.onMessage.addListener((e,t,n)=>{if(!this._isBusMsg(e))return;let r=this._callHandlers(e);if(r)return r.then(this._serialize).then(n),!0}),window.addEventListener(`message`,async({data:t})=>{if(this._isBusMsg(t)&&t.locus===`ppDesktop`){if(t.name===`bus.proxy`){let[n,r]=t.args;r?this._on(n,`ppDesktop`,(...e)=>this._sendToPage(n,...e)):this._off(n,`ppDesktop`),e(t);return}e(t,await this._pick([this._sendToExt(t.name,...t.args),this._callHandlers(t,e=>!e.proxy)]))}});let e=(e,t=null)=>{window.postMessage({resId:e.reqId,result:t},`*`)};async:this._sendToProxier(`bus.removeCsProxies`);k.execute(e=>{globalThis.__$busToken__=e},this._token)},_setupPpDesktop(){let e=window.__$bus_njOnMsg__;e&&window.removeEventListener(`message`,e),e=async({data:e})=>{if(!this._isBusMsg(e)||e.locus!==`csDesktop`)return;let t=await this._callHandlers(e);window.postMessage({resId:e.reqId,result:t},`*`)},window.addEventListener(`message`,e),window.__$bus_njOnMsg__=e},_setupOs(){chrome.runtime.onMessage.addListener((e,t,n)=>{if(!this._isBusMsg(e))return;let r=this._callHandlers(e);if(r)return r.then(this._serialize).then(n),!0}),window.addEventListener(`message`,async({data:t})=>{if(this._isBusMsg(t)){if(t.name===`bus.proxy`){let[n,r]=t.args;r?this._on(n,`ppFrame`,(...e)=>this._sendToIframe(n,...e)):this._off(n,`ppFrame`),e(t);return}e(t,await this._pick([this._sendToExt(t.name,...t.args),this._callHandlers(t,e=>!e.proxy)]))}});let e=(e,t=null)=>{this._iframe.contentWindow.postMessage({resId:e.reqId,result:t},`*`)};this._channel.addEventListener(`message`,({data:e})=>{let{blob:t,reqId:n}=e,r=k.objectUrl.create(t,!0);this._channel.postMessage({resId:n,objectUrl:r})})},_setupPpFrame(){window.addEventListener(`message`,async({data:e})=>{if(!this._isBusMsg(e))return;let t=await this._callHandlers(e);window.parent.postMessage({resId:e.reqId,result:t},`*`)})},async _sendToExt(e,...t){let n=this._serialize(t),r=this._createBusMsg({name:e,argsStr:n});try{let e=await chrome.runtime.sendMessage(r);return await this._deserialize(e)}catch(e){return this._isIgnoredExtError(e)||console.error(e),null}},_isIgnoredExtError(e){if(!(e instanceof Error))return!1;let t=(e.message||``).toLowerCase();return t.includes(`receiving end does not exist`)||t.includes(`extension context invalidated`)||t.includes(`closed before a response was received`)},async _sendToTab(e,t,...n){if(!chrome.tabs?.sendMessage)return await this.send(`bus.sendToTab`,e,t,...n);let r=this._serialize(n),i=this._createBusMsg({name:t,argsStr:r});try{let t=await chrome.tabs.sendMessage(e,i);return await this._deserialize(t)}catch(e){return D.error(e),null}},async _sendToPage(e,...t){let n=this._generateId(),r=this._locus,i=this._token,a=this._createBusMsg({name:e,args:t,reqId:n,locus:r,token:i});return window.postMessage(a,`*`),await this._waitForResponseMessage(n)},async _sendToIframe(e,...t){if(!this._iframe)return null;let n=this._generateId(),r=this._createBusMsg({name:e,args:t,reqId:n});return this._iframe.contentWindow.postMessage(r,`*`),await this._waitForResponseMessage(n)},async _sendToParent(e,...t){let n=this._generateId(),r=this._createBusMsg({name:e,args:t,reqId:n});return parent.postMessage(r,`*`),await this._waitForResponseMessage(n)},async _sendToProxier(e,...t){if(this._is(`csDesktop`))return await this._sendToExt(e,...t);if(this._is(`ppDesktop`))return await this._sendToPage(e,...t);if(this._is(`ppFrame`))return await this._sendToParent(e,...t)},async _waitForResponseMessage(e){return await new Promise(t=>{let n=({data:r})=>{r&&r.resId===e&&(window.removeEventListener(`message`,n),t(r.result))};window.addEventListener(`message`,n)})},_callHandlers({name:e,args:t,argsStr:n},r=null){let i=this._handlers[e];return!i||(r&&(i=i.filter(r)),i.length===0)?null:new Promise(async e=>{n&&(t=await this._deserialize(n)),e(await this._pick(i.map(async e=>{try{return await e.fn.call(e.this,...t)}catch(t){return D.error(`failed to handle "${e.name}".`,t),t}})))})},_removeProxyHandlers(e){Object.keys(this._handlers).forEach(t=>{this._handlers[t]=this._handlers[t].filter(t=>t.proxy!==e),this._handlers[t].length===0&&delete this._handlers[t]})},_serialize(e){return k.is.nil(e)?null:this._hasSpecialTypes(e)?`x:${JSON.stringify(e,(e,t)=>{if(k.is.blob(t))if(this._is(`bg`)){let e=this._generateId();return this._blobs[e]=t,`bus.blob.${e}`}else return`bus.blob.${k.objectUrl.create(t,!0)}`;return k.is.error(t)?`bus.error.${t.message}`:t})}`:`f:${JSON.stringify(e)}`},_hasSpecialTypes(e,t=new Set){if(e&&typeof e==`object`){if(t.has(e))return!1;t.add(e)}if(k.is.blob(e)||k.is.error(e))return!0;if(k.is.array(e)){for(let n of e)if(this._hasSpecialTypes(n,t))return!0}if(k.is.object(e)){for(let n in e)if(this._hasSpecialTypes(e[n],t))return!0}return!1},async _deserialize(e){if(!k.is.string(e))return null;let t=e.slice(0,2);if(t===`f:`){let t=e.slice(2);return JSON.parse(t)}let n=t===`x:`?e.slice(2):e,r=new Map,i=JSON.parse(n,(e,t)=>{let n=k.is.string(t);return n&&t.startsWith(`bus.blob.`)?(r.set(t,t.slice(9)),t):n&&t.startsWith(`bus.error.`)?Error(t.slice(10)):t});return await Promise.all([...r.keys()].map(async e=>{let t,n=r.get(e);t=n.startsWith(`blob:`)?n:await this._sendToExt(`bus.blobIdToObjectUrl`,n);let i=await fetch(t).then(e=>e.blob());r.set(e,i)})),this._applyBlobs(i,r)},_applyBlobs(e,t){if(t.has(e))return t.get(e);if(k.is.array(e)||k.is.object(e))for(let n in e)e[n]=this._applyBlobs(e[n],t);return e},async _blobIdToObjectUrl(e){let t=this._blobs[e],n;return k.is.string(t)?n=t:(n=await this._blobToObjectUrl(t),this._blobs[e]=n),setTimeout(()=>delete this._blobs[e],6e4),n},async _blobToObjectUrl(e){let t=this._generateId();return this._channel.postMessage({reqId:t,blob:e}),await new Promise(e=>{let n=({data:r})=>{r&&r.resId===t&&(this._channel.removeEventListener(`message`,n),e(r.objectUrl))};this._channel.addEventListener(`message`,n)})},_is(...e){return e.includes(this._locus)},_isBusMsg(e){return!!(e&&e.$bus===app.name)},_createBusMsg(e){return{$bus:app.name,...e}},_generateId(){return`bus-${Date.now()}-${Math.random().toString(36).slice(2)}`},_wrapThrowIfError(e){return async(...t)=>{let n=await e.call(this,...t);if(k.is.error(n))throw n;return n}},async _pick(e=[]){return e.length===0?null:await new Promise(t=>{let n=0;e.forEach(async r=>{let i=await r;if(!k.is.nil(i))return t(i);if(n===e.length-1)return t(null);n++})})},_setIframe(e){this._iframe&&this._removeProxyHandlers(`ppFrame`),this._iframe=e}}})),A,se=e((()=>{({$utils:A}=app),A.docElem=document.documentElement})),j,ce=e((()=>{({$utils:j}=app),j.execute=(e,...t)=>{let n=`(${e.toString()}).call(null, ...${JSON.stringify(t)})`,r=document.createElement(`div`);r.setAttribute(`onreset`,`const URL = window.URL; ${n}`),r.dispatchEvent(new Event(`reset`))}})),M,le=e((()=>{({$utils:M}=app),M.executeScript=e=>{let t=document.createElement(`div`),n=e.replace(`<script>`,`(() => {`).replace(`<\/script>`,`})()`);t.setAttribute(`onreset`,`const URL = window.URL; ${n}`),t.dispatchEvent(new Event(`reset`))}})),ue=e((()=>{se(),le(),ce(),c(),u(),ee(),ne(),re(),ie()})),de=e((()=>{ae()})),fe=e((()=>{oe()})),N,pe=e((()=>{({$dm:N}=app),N.controller={init(){N.ravenController.init()}}})),P,F,me=e((()=>{({$dm:P,$utils:F}=app),P.ravenController={init(){this._patchRavenMessages()},_patchRavenMessages(){F.execute(()=>{$inssist.ig.patch((e,t)=>{if(e===`IGDRavenMessage.react`)return t.replace(/(?:\["default"\]|\.default)=(\w)/,`["default"] = (props) => {
            const result = $1(props);
            return require('react').jsx('div', {
              'data-raven-attachment': JSON.stringify(props.attachment),
              children: result
            });
          }`)})})}}})),he=e((()=>{pe(),me()})),I,L,ge=e((()=>{({$theme:I,$utils:L}=app),I.controller={init(){this._fixPageBg(),this._syncWithIgTheme()},_fixPageBg(){L.execute(()=>{let e=localStorage.getItem(`theme`);if(!e)return;let t=e===`day`?`#fff`:`#000`,n=document.createElement(`style`);n.textContent=`
        html:not([class*="__fb"]) {
          background: ${t} !important;
          body { background: ${t} !important; }
        }
      `,document.documentElement.prepend(n)})},_syncWithIgTheme(){L.execute(async()=>{let e=null,t=Symbol(`useTheme`);Object.defineProperty(Object.prototype,`useTheme`,{get(){return this[t]},set(n){return this[t]=(...t)=>{let r=n.call(this,...t);if(!r.setTheme)return r;e=r;let i=e.toggleTheme;return e.toggleTheme=async()=>{let t=e.getTheme();i();let{$s:n}=await $inssist.app;n.theme=t===`dark`?`day`:`night`},e},!0}});let{$mobx:n,$s:r}=await $inssist.app;n.reaction(()=>r.theme,()=>{let t=r.theme===`day`?`light`:`dark`;localStorage.setItem(`igt`,t),e&&e.getTheme()!==t&&e.setTheme(t)},{fireImmediately:!0})})}}})),_e=e((()=>{ge()})),R,z,ve=e((()=>{({$patch:R,$utils:z}=app),R.controller={init(){this._initUse(),this._initPatch(),this._patchXhr(),this._hideIgLogs(),this._disableHydration(),this._patchClassNames(),this._handleRejections(),this._interceptStore(),this._interceptEditor(),this._interceptRouter(),this._interceptVolumeManager(),this._forceEnableFeedSidebar()},_initUse(){z.execute(()=>{$inssist.ig.use=async e=>(await new Promise((t,n)=>{if(window.requireLazy){t();return}let r=setTimeout(()=>{clearInterval(i),n(Error(`Failed to load module "${e}"`))},5e3),i=setInterval(()=>{window.requireLazy&&(clearTimeout(r),clearInterval(i),t())},20)}),await new Promise((t,n)=>{window.requireLazy([e],e=>{clearTimeout(r),t(e)});let r=setTimeout(()=>{n(Error(`Failed to load module "${e}"`))},5e3)}))})},_initPatch(){z.execute(()=>{$inssist.ig.patch=t=>e.push(t);let e=[],t=Symbol(`original __d`),n=Symbol(`patched __d`);Object.defineProperty(Object.prototype,`__d`,{get(){return this[n]??=(...n)=>{let r=n[0],i=n[2].toString(),a=i.split(`(`)[1].split(`)`)[0],o=i.indexOf(`{`),s=i.lastIndexOf(`}`),c=i.slice(o+1,s);return e.forEach(e=>{try{let t=e(r,c);t&&(c=t,n[2]=Function(a,t))}catch(e){console.error(`Failed to patch "${r}"`,{body:c}),console.error(e)}}),this[t](...n)},this[n]},set(e){return this[t]=e,!0}})})},_patchXhr(){z.execute(()=>{let e=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,n){return this._url=n,this._method=t,e.call(this,...arguments)}})},_hideIgLogs(){z.execute(()=>{let e=console.log.bind(console);console.log=(...t)=>{typeof t[0]==`string`&&t[0].startsWith(`
%c`)||e(...t)};let t=console.error.bind(console);console.error=(...e)=>{typeof e[0]==`string`&&e[0].startsWith(`ErrorUtils`)||t(...e)}})},_disableHydration(){z.execute(()=>{let e=Symbol(`hydrateRoot`);Object.defineProperty(Object.prototype,`hydrateRoot`,{get(){return(...t)=>{try{window.require(`ReactDOM`).render(t[1],t[0])}catch(n){return console.error(`Failed to render`,n),this[e](...t)}}},set(t){return this[e]=t,!0}})})},_patchClassNames(){z.execute(()=>{$inssist.ig.patch((e,t)=>{if(!t.includes(`className:`))return;let n=e.replaceAll(`.react`,``).replaceAll(`.`,`_`).replaceAll(`_DEPRECATED`,``);return t.replaceAll(`className:`,`className: "${n} " +`)})})},_handleRejections(){z.execute(()=>{$inssist.ig.patch((e,t)=>{if(e===`fb-error`)return t.replace(`preventDefault()`,`preventDefault`)}),window.addEventListener(`unhandledrejection`,e=>{e.reason===`should not be called for IGD`&&e.preventDefault()})})},_interceptStore(){z.execute(()=>{let e=window.setTimeout.bind(window),t=window.clearTimeout.bind(window),n=e(()=>{console.error(`Failed to intercept store`)},1e4),r=Symbol(`createStore`);Reflect.defineProperty(Object.prototype,`createStore`,{get(){return this[r]},set(e){return this[r]=(r,i)=>{let a=[],o=e((e,t)=>(a.forEach(n=>n(t,e)),r(e,t)),i);return o.onAction=e=>a.push(e),$inssist.ig.store$.resolve(o),t(n),o},!0}})})},_interceptEditor(){z.execute(()=>{$inssist.ig.patch((e,t)=>{if(e===`MWPCometComposerInner.react`)return t.replace(`;return`,`;$inssist.ig.editor = arguments[0].editor; return`)})})},_interceptRouter(){z.execute(()=>{$inssist.ig.patch((e,t)=>{if(e!==`useCometRouterDispatcher`)return;let n=[`["default"] = () => {`,`  const router = $1();`,`  $inssist.ig.router = router;`,`  return router;`,`};`].join(`
`);return t.replace(/\["default"\]=(\w)/,n).replace(/\.default=(\w)/,n)})})},_interceptVolumeManager(){z.execute(()=>{let e=Symbol(`useVolumeControls`);Object.defineProperty(Object.prototype,`useVolumeControls`,{get(){return this[e]},set(t){return this[e]=(...e)=>{let n=t(...e);return $inssist.ig.volumeManager=n,n},!0}})})},_forceEnableFeedSidebar(){z.execute(()=>{$inssist.ig.patch((e,t)=>{if(e===`shouldShowStorySUPogs`)return t=t.replace(/\.default=(\w)/,`.default = () => false`).replace(/\["default"\]=(\w)/,`["default"] = () => false`),t})})}}})),ye=e((()=>{ve()})),B,V,be=e((()=>{({$adblock:B,$utils:V}=app),B.controller={init(){this._removeAdsFromRequests()},_removeAdsFromRequests(){V.execute(()=>{let e=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=async function(...t){let{$s:n}=await $inssist.app;if(!n.adblock.enabled||this._url!==`/graphql/query`)return e.apply(this,t);let r=this,i=r.onreadystatechange;return r.onreadystatechange=function(){if(r.readyState===4)try{let e=JSON.parse(r.responseText),t=!1,i=e?.data?.xdt_injected_story_units;if(Array.isArray(i?.ad_media_items)){let e=i.ad_media_items.length;i.ad_media_items=[],e>0&&(t=!0,n.adblock.adsStoryRemoved+=e)}let a=e?.data?.xdt_api__v1__feed__timeline__connection;if(Array.isArray(a?.edges)){let e=a.edges.length;a.edges=a.edges.filter(e=>!e.node?.ad);let r=e-a.edges.length;r>0&&(t=!0,n.adblock.adsFeedRemoved+=r)}if(t){let t=JSON.stringify(e);Object.defineProperty(r,`response`,{value:t,writable:!1,configurable:!0}),Object.defineProperty(r,`responseText`,{value:t,writable:!1,configurable:!0})}}catch(e){console.error(`Failed patching response:`,e)}i&&i.apply(r,arguments)},e.apply(this,t)}})}}})),xe=e((()=>{be()})),H,Se=e((()=>{({$ghost:H}=app),H.controller={init(){H.dmController.init(),H.storyController.init()}}})),U,W,Ce=e((()=>{({$ghost:U,$utils:W}=app),U.dmController={init(){this._patchRequest(),this._patchAction()},_patchRequest(){W.execute(()=>{let e=WebSocket.prototype.send;WebSocket.prototype.send=async function(...t){let{$s:n}=await $inssist.app;if(n.ghost.enabled)try{if(new TextDecoder().decode(t[0]).includes(`last_read_watermark_ts`))return}catch(e){console.error(`failed to decode ws message`,e)}return e.call(this,...t)}})},_patchAction(){W.execute(()=>{$inssist.ig.patch((e,t)=>{if(e===`LSOptimisticMarkThreadReadV2`)return t.replace(/(\w\.exports)=(\w)/,`$1 = async (...args) => {
            const { $s } = await $inssist.app
            if ($s.ghost.enabled) return
            $2(...args)
          }`)})})}}})),G,K,we=e((()=>{({$ghost:G,$utils:K}=app),G.storyController={init(){this._patchRequest(),this._patchAction()},_patchRequest(){K.execute(()=>{let e=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=async function(t){let{$s:n}=await $inssist.app;if(!(n.ghost.enabled&&this._method===`POST`&&this._url.includes(`/graphql/query`)&&typeof t==`string`&&t.includes(`viewSeenAt`)))return e.call(this,t)}})},_patchAction(){K.execute(async()=>{let{$s:e}=await $inssist.app,t=await $inssist.ig.store;t.onAction(t=>{e.ghost.enabled&&t.type===`STORY_REELS_ITEM_SEEN`&&(t.type=null)});let n=!1;t.onAction(e=>{e.type===`NAVIGATION_LOCATION_CHANGED`?n=e.nextPath.startsWith(`/stories/`):e.type===`STORY_TRAY_RELAY_SYNC`&&n&&(e.type=null)})})}}})),Te=e((()=>{Se(),Ce(),we()})),q,J,Ee=e((()=>{({$media:q,$utils:J}=app),q.controller={init(){this._patchFeedPost(),this._patchModalPost(),this._patchPagePost(),this._patchReels(),this._patchVideos()},_patchFeedPost(){J.execute(()=>{let e=!1;$inssist.ig.patch((t,n)=>{if(t===`PolarisFeedCard.react`&&!e)return e=!0,n=n.replace(/function (\w)\((\w)\){/,`function $1($2) { const __props = $2;`),n=n.replace(/("data-testid":[^,]+),/,`$1, "data-post-id": __props?.mediaFragmentKey?.pk ?? null,`),n})})},_patchModalPost(){J.execute(()=>{$inssist.ig.patch((e,t)=>{if(e===`PolarisPost.react`)return t=t.replace(/function (\w)\((\w)\){/,`function $1($2) { const __props = $2;`),t=t.replace(/("data-testid":[^,]+),/,`$1, "data-post-id": __props.id ?? null,`),t})})},_patchPagePost(){J.execute(()=>{$inssist.ig.patch((e,t)=>{if(e===`PolarisDesktopPost.react`)return t=t.replace(/function (\w)\((\w)\){/,`function $1($2) { const __props = $2;`),t=t.replace(/("data-testid":[^,]+),/,`$1, "data-post-id": __props?.queryReference?.pk ?? null,`),t})})},_patchReels(){J.execute(()=>{$inssist.ig.patch((e,t)=>{if(e===`PolarisClipsDesktopVideoPlayer.react`)return t=t.replace(/(\w)\.queryReference,/,`$1.queryReference, __props = $1,`),t=t.replace(`className:`,[`"data-reel-id": __props?.queryReference?.pk ?? null,`,`"data-post-code": __props?.queryReference?.code ?? null,`,`"data-owner-id": __props?.queryReference?.user?.id ?? null,`,`className:`].join(``)),t})})},_patchVideos(){J.execute(()=>{$inssist.ig.patch((e,t)=>{if(e===`PolarisVideo.react`)return t=t.replace(/function (\w)\((\w)\){/,`function $1($2) { const __props = $2;`),t=t.replace(/alt:\w/,`alt: __props.hdSrc`),t});let e=!1;$inssist.ig.patch((t,n)=>{if(t===`VideoPlayerPortalingPlace.react`&&!e)return e=!0,n=n.replace(`"use strict";`,`"use strict"; let __props = null;`),n=n.replace(/function (\w)\((\w)\){/,`function $1($2) { __props = $2;`),n=n.replace(/testid:[^,]+,/g,`testid:__props?.alt ?? null,`),n})})}}})),De=e((()=>{Ee()})),Y,Oe,ke,Ae=e((()=>{({$boost:Y,$utils:Oe,$bus:ke}=app),Y.controller={init(){this._injectSuggestions()},async _getSuggestions(){return await ke.send(`boost.getSuggestions`)},async _injectSuggestions(){let e=await this._getSuggestions();!e||!e.length||Oe.execute(e=>{let t=e.map(e=>e.username);document.documentElement.setAttribute(`data-suggestion-usernames`,JSON.stringify(t));let n=e=>e.nodeType===Node.ELEMENT_NODE&&e.tagName===`SCRIPT`&&e.getAttribute(`type`)===`application/json`&&e.textContent.includes(`SuggestedUserList`),r=e=>{if(!e||typeof e!=`object`)return null;if(Array.isArray(e)){if(e.length>0&&e.every(e=>typeof e==`object`&&!!e&&`user`in e&&e.user!==null&&typeof e.user==`object`&&!Array.isArray(e.user)))return e;for(let t of e){let e=r(t);if(e)return e}}else for(let t in e){let n=r(e[t]);if(n)return n}return null},i=e=>{try{let t=JSON.parse(e.textContent);return{data:t,items:r(t)}}catch{return{data:null,items:null}}},a=e=>{let t=(document.documentElement.lang||`en`).slice(0,2),n={en:`Suggested for you`,es:`Sugerencia para ti`,pt:`Sugestões para você`,hi:`आपके लिए सुझाव`,ja:`おすすめ`};if(n[t])return n[t];let r=e.map(e=>e.user&&e.user.social_context?e.user.social_context:null).filter(e=>e!==null);if(r.length===0)return null;let i={};r.forEach(e=>{i[e]=(i[e]||0)+1});let a=0,o=null;for(let e in i)i[e]>a&&(a=i[e],o=e);return a===1&&Object.keys(i).length>1?r[r.length-1]:o},o=(e,t,n)=>{for(let r=0;r<e.length;r++){let i=t[r];if(!i)continue;let a=e[r];Object.assign(a.user,i),a.social_context_facepile_users=[],n&&!i.social_context&&(a.user.social_context=n)}},s=(e,t)=>{e.textContent=JSON.stringify(t),e.setAttribute(`data-content-len`,e.textContent.length)},c=new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(async t=>{if(!n(t))return;let{data:r,items:l}=i(t);!l||!l.length||(c.disconnect(),o(l,e,a(l)),s(t,r))})})});c.observe(document.documentElement,{childList:!0,subtree:!0});let l=(e,t)=>{if(e!==`/graphql/query`)return!1;try{if(!decodeURIComponent(t).includes(`"module":"discover_people"`))return!1}catch{return!1}return!0},u=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=async function(...t){if(!l(this._url,t))return u.apply(this,t);let n=this,i=n.onreadystatechange;return n.onreadystatechange=function(){if(n.readyState===4)try{let t=JSON.parse(n.responseText),i=!1,s=r(t?.data);if(s&&s.length>0&&(o(s,e,a(s)),i=!0),i){let e=JSON.stringify(t);Object.defineProperty(n,`response`,{value:e,writable:!1,configurable:!0}),Object.defineProperty(n,`responseText`,{value:e,writable:!1,configurable:!0})}}catch(e){console.error(`Failed patching response:`,e)}i&&i.apply(n,arguments)},u.apply(this,t)}},e)}}})),je=e((()=>{Ae()})),X,Z,Me,Ne,Pe,Q,Fe,Ie,Le,Re,$,ze=e((()=>{({$startup:X,$env:Z,$adblock:Me,$patch:Ne,$bus:Pe,$utils:Q,$ghost:Fe,$media:Ie,$theme:Le,$boost:Re,$dm:$}=app),X.controller={async init(){if(Z.controller.init(),Z.is.csFrame){this._inject(`/app/pp.js`);return}this._initInssistGlobalVar(),Ne.controller.init(),Ie.controller.init(),Fe.controller.init(),Le.controller.init(),Me.controller.init(),Pe.controller.init(),Re.controller.init(),$.controller.init(),this._createShadow(),this._renderGlamorInsideShadow(),this._inject(`/app/tw.css`),this._inject(`/app/embed.css`),this._inject(`/app/pp.js`),this._injectFonts(),Z.controller.logReady()},_initInssistGlobalVar(){Q.execute(e=>{let t=Promise.withResolvers(),n=Promise.withResolvers();window.$inssist={url:t=>new URL(t,e).href,app:t.promise,app$:t,ig:{use:null,patch:null,store:n.promise,store$:n,editor:null,router:null,volumeManager:null}}},chrome.runtime.getURL(`/`))},_createShadow(){let e={ppCssUrl:chrome.runtime.getURL(`/app/pp.css`),twCssUrl:chrome.runtime.getURL(`/app/tw.css`)};Q.execute(({ppCssUrl:e,twCssUrl:t})=>{let n=document.createElement(`div`);n.id=`shadow`,document.documentElement.insertAdjacentElement(`afterbegin`,n),n.attachShadow({mode:`open`});let r=document.createElement(`div`);r.id=`origin`,n.shadowRoot.append(r),r.style.background=`transparent`;let i=document.createElement(`link`);i.rel=`stylesheet`,i.href=e,r.appendChild(i);let a=document.createElement(`link`);a.rel=`stylesheet`,a.href=t,r.appendChild(a);let o=document.createElement(`div`);o.id=`root`,r.append(o)},e)},_renderGlamorInsideShadow(){Q.execute(()=>{let e=HTMLElement.prototype.appendChild;HTMLElement.prototype.appendChild=function(...t){if(this===document.head&&t[0]instanceof HTMLStyleElement&&t[0].hasAttribute(`data-glamor`)){document.getElementById(`shadow`).shadowRoot.getElementById(`origin`).append(t[0]);return}return e.call(this,...t)}})},_inject(e){if(e.endsWith(`.js`)){let t=document.createElement(`script`);t.onload=()=>t.remove(),t.src=chrome.runtime.getURL(e),document.documentElement.prepend(t)}else if(e.endsWith(`.css`)){let t=document.createElement(`link`);t.rel=`stylesheet`,t.href=chrome.runtime.getURL(e),document.documentElement.prepend(t)}},_injectFonts(){let e=document.createElement(`link`);e.rel=`stylesheet`,e.href=`https://fonts.googleapis.com/css?family=Montserrat:400,500,600,700|Nunito+Sans:400,700|Roboto+Mono:400&display=fallback&subset=cyrillic,cyrillic-ext,latin-ext,vietnamese`,document.documentElement.prepend(e)}},X.controller.init()})),Be=e((()=>{ue(),de(),fe(),he(),_e(),ye(),xe(),Te(),De(),je(),ze()}));e((()=>{n(),Be()}))()})();